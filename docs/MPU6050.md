# MPU6050 Module Documentation

## Overview

The `MPU6050` module is designed to interface with the MPU6050 sensor using the I2C protocol. It provides functionalities to initialize the sensor, read raw data from the accelerometer and gyroscope, and process this data. This documentation outlines the setup and usage of the `MPU6050` class.

## Configuration

Before using the `MPU6050` module, you need to configure it in the `config/mpu6050.yml` file. Below is an explanation of the configuration options:

```yaml
mpu6050:
  enabled: false  # Set to true to enable the MPU6050 module
  path: modules.mpu6050.MPU6050  # Path to the MPU6050 class
  config:
    test_on_boot: false  # Set to true to run a test on boot
  dependencies:
    unix:
      - python3-smbus
    python:
      - smbus
```

### Dependencies

After enabling the module, run `./install.sh` to install the required dependencies. The dependencies are listed under `dependencies` in the configuration file. Check the output to ensure that the dependencies are installed correctly.

## Usage

### Initializing the MPU6050

When the module is enabled in the config YAML, the `MPU6050` class is automatically imported and initialized.

You can also reference the `MPU6050` class directly in the `main.py`:

```python
module = module_instances['mpu6050']  # Get the MPU6050 module instance
module.read_data()  # Start reading data from the sensor
```

### Reading Data

The `MPU6050` class provides methods to read raw data from the accelerometer and gyroscope. Here’s an example of how to read data:

```python
def read_data(self):
    print("Reading Data of Gyroscope and Accelerometer")
    while True:
        try:
            # Read Accelerometer raw value
            acc_x = self.read_raw_data(ACCEL_XOUT_H)
            acc_y = self.read_raw_data(ACCEL_YOUT_H)
            acc_z = self.read_raw_data(ACCEL_ZOUT_H)
            
            # Read Gyroscope raw value
            gyro_x = self.read_raw_data(GYRO_XOUT_H)
            gyro_y = self.read_raw_data(GYRO_YOUT_H)
            gyro_z = self.read_raw_data(GYRO_ZOUT_H)
        except OSError:
            continue
        
        # Full scale range +/- 250 degree/C as per sensitivity scale factor
        Ax = acc_x / 16384.0
        Ay = acc_y / 16384.0
        Az = acc_z / 16384.0
        
        Gx = gyro_x / 131.0
        Gy = gyro_y / 131.0
        Gz = gyro_z / 131.0
        
        print(f"Gx={Gx:.2f}°/s\tGy={Gy:.2f}°/s\tGz={Gz:.2f}°/s\tAx={Ax:.2f} g\tAy={Ay:.2f} g\tAz={Az:.2f} g")
        sleep(0.1)
```

### Handling Errors

The `MPU6050` class includes error handling for I2C communication errors. If an `OSError` occurs, it will be caught and ignored, allowing the script to continue running:

```python
except OSError:
    continue
```

## Conclusion

The `MPU6050` module provides a straightforward interface for working with the MPU6050 sensor in Python. By following the configuration and usage instructions outlined in this documentation, you can effectively integrate and utilize the MPU6050 sensor in your projects.